!function(){var t,n,r,e,a;t={target:"中華統一促進黨"},n=d3.interpolateInferno,r=function(){if(window.innerWidth<768)return scrollto("#popularity-by-party-anchor")},e=new ldView({root:'div[ld-scope="popularity-by-party-map"]',initRender:!1,handler:{label:{list:function(){return[1].concat(function(){var n,r,e,a=[];for(n=t.range.max,e=t.range.min,r=-t.range.size/6;r<0?n>=e:n<=e;n+=r)a.push(n);return a}()).sort(function(t,n){return n-t})},handle:function(r){var e,a,i,o;return e=r.data,a=r.node,i=r.idx,o=(e-t.range.min)/t.range.size,a.style.order=i,ld$.find(a,".dot",0).style.background=n(o),ld$.find(a,".name",0).innerHTML=(1===e?"<span class='text-sm'>(全國平均)</span>":"")+Math.round(100*e)/100+"<span class='text-sm'>倍</span>"}}}}),a=debounce(50,function(){var r,a,i,o,u,p;t.map.fit(),t.rate=r={};for(a in i=t.data)o=i[a],"全國"!==a&&(r[a]=o[t.target]/o["總計"]/(t.data["全國"][t.target]/t.data["全國"]["總計"]));p=[];for(a in r)o=r[a],p.push(o);return u=p,t.range={min:Math.min.apply(null,u),max:Math.max.apply(null,u)},t.range.size=t.range.max-t.range.min,e.render(),d3.select(t.map.root).selectAll("path").attr("stroke",function(){return"#fff"}).attr("stroke-width",function(){return.001}).transition().duration(350).attr("fill",function(e){var a,i;return a=r[e.properties.name],i=(a-t.range.min)/(t.range.max-t.range.min),n(i)})}),t.map=pdmaptw.create({root:ld$.find(document,"#map-popularity-by-party-map",0),type:"town",popup:popupWrap(function(n){var r,e;return r=n.data,n.evt,e=n.node,e.innerHTML+="<div>"+Math.round(100*t.rate[r.properties.name])/100+"<span class='text-sm'>倍</span></div>"})}),t.map.init().then(function(){return ld$.fetch("assets/data/政黨票.json",{method:"GET"},{type:"json"})}).then(function(n){var r;return t.data=n,t.party=function(){var n=[];for(r in t.data["台東縣成功鎮"])n.push(r);return n}().filter(function(t){return"總計"!==t})}).then(function(){var n;return(n=new ldView({root:'[ld-scope="popularity-by-party"]',action:{input:{"party-select":function(e){var i;return i=e.node,t.target=i.value,n.getAll("party-select").map(function(t){return t.value=i.value}),r(),a()}},click:{setparty:function(e){var i;return i=e.node,n.get("party-select").value=t.target=i.getAttribute("data-value"),r(),a()}}},handler:{"party-option":{list:function(){return t.party},handle:function(t){var n,r;return n=t.data,r=t.node,r.innerText=n,r.setAttribute("value",n)}}}})).getAll("party-select").map(function(t){return t.value="中華統一促進黨"})}).then(function(){return a()})}();